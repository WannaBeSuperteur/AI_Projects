
## ëª©ì°¨

* [1. ë™ì‘ ì›ë¦¬](#1-ë™ì‘-ì›ë¦¬)
* [2. ì‹¤í—˜ ê²°ê³¼](#2-ì‹¤í—˜-ê²°ê³¼)
  * [2-1. S-BERT ëª¨ë¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼ (5, 10, 20, 40 epochs)](#2-1-s-bert-ëª¨ë¸-í…ŒìŠ¤íŠ¸-ê²°ê³¼-5-10-20-40-epochs)
  * [2-2. S-BERT ìµœì¢… ëª¨ë¸ ì˜¤ë‹µ ë¶„ì„ (output_answered)](#2-2-s-bert-ìµœì¢…-ëª¨ë¸-ì˜¤ë‹µ-ë¶„ì„-output_answered)
  * [2-3. LLM í…ŒìŠ¤íŠ¸ ê²°ê³¼](#2-3-llm-í…ŒìŠ¤íŠ¸-ê²°ê³¼)
* [3. ì½”ë“œ ì‹¤í–‰ ë°©ë²•](#3-ì½”ë“œ-ì‹¤í–‰-ë°©ë²•)
  * [3-1. S-BERT Training (ì‚¬ìš©ìê°€ ì„±ê³µì ìœ¼ë¡œ í•œ ë‹µë³€, ë‹¤ìŒ ì§ˆë¬¸ ì˜ˆì¸¡ ê°ê°)](#3-1-s-bert-training-ì‚¬ìš©ìê°€-ì„±ê³µì ìœ¼ë¡œ-í•œ-ë‹µë³€-ë‹¤ìŒ-ì§ˆë¬¸-ì˜ˆì¸¡-ê°ê°)
  * [3-2. S-BERT ëª¨ë¸ì˜ ì •í™•ë„ ì¸¡ì •](#3-2-s-bert-ëª¨ë¸ì˜-ì •í™•ë„-ì¸¡ì •)
  * [3-3. LLM Inference ë˜ëŠ” Fine-Tuning](#3-3-llm-inference-ë˜ëŠ”-fine-tuning)

## 1. ë™ì‘ ì›ë¦¬

* ì „ì²´ êµ¬ì¡°

![image](../../images/250702_16.PNG)

* ì‚¬ìš© ëª¨ë¸

| ê¸°ëŠ¥               | ì‚¬ìš© ëª¨ë¸        | í•„ìš” (ì…ë ¥) ë°ì´í„°                                          | ì¶œë ¥ ë°ì´í„°                   |
|------------------|--------------|------------------------------------------------------|--------------------------|
| ì‚¬ìš©ì ë‹µë³€ ì„±ê³µ ì—¬ë¶€ í‰ê°€  | S-BERT       | ```í˜„ì¬ ì§ˆë¬¸``` ```ì‚¬ìš©ì ë‹µë³€```                             | ```ì„±ê³µí•œ ë‹µë³€``` ```ë‚¨ì€ ë‹µë³€``` |
| ë‹¤ìŒ ì§ˆë¬¸ ì„ íƒ         | S-BERT       | ```í˜„ì¬ ì§ˆë¬¸``` ```ì‚¬ìš©ì ë‹µë³€``` ```ë‚¨ì€ ë‹µë³€```                 | ```ë‹¤ìŒì— í•  ì§ˆë¬¸```           |
| LLMì— ì˜í•œ ë‹¤ìŒ ì§ˆë¬¸ ìƒì„± | LLM (Causal) | ```í˜„ì¬ ì§ˆë¬¸``` ```ì‚¬ìš©ì ë‹µë³€``` ```ì„±ê³µí•œ ë‹µë³€``` ```ë‹¤ìŒì— í•  ì§ˆë¬¸``` | ìƒì„±ëœ ë‹¤ìŒ ì§ˆë¬¸ ë‚´ìš©             |

### 1-1. ì‚¬ìš©ì ë‹µë³€ ì„±ê³µ ì—¬ë¶€ í‰ê°€

![image](../../images/250702_13.PNG)

* ì‚¬ìš© ëª¨ë¸
  * [S-BERT (Sentence BERT)](https://github.com/WannaBeSuperteur/AI-study/blob/main/Natural%20Language%20Processing/Basics_BERT%2C%20SBERT%20%EB%AA%A8%EB%8D%B8.md)
* ì…ë ¥ ë°ì´í„°
  * í˜„ì¬ ì§ˆë¬¸ ```current_question``` & ì‚¬ìš©ì ë‹µë³€ ```user_input```
  * ê°ê°ì˜ '(ì‚¬ìš©ìê°€) ì„±ê³µí•œ ë‹µë³€' (```output_answered```) í›„ë³´
* ì¶œë ¥ ê°’
  * Cosine Similarity (ìœ ì‚¬ë„)

| í•™ìŠµ ë°ì´í„°                                                                       | í…ŒìŠ¤íŠ¸ ë°ì´í„°                                                                                | ```output_answered``` candidates                                                                                                                           |
|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [dataset_df_answer_type_train.csv](dataset/dataset_df_answer_type_train.csv) | [dataset_df_answer_type_valid_test.csv](dataset/dataset_df_answer_type_valid_test.csv) | - í›„ë³´ ëª©ë¡: [candidates_answer_type.txt](dataset/candidates_answer_type.txt)<br>- ë²¡í„° ì„ë² ë”© í¬í•¨: [embeddings_answer_type.csv](dataset/embeddings_answer_type.csv) |

### 1-2. ë‹¤ìŒ ì§ˆë¬¸ ì„ íƒ

![image](../../images/250702_14.PNG)

* ì‚¬ìš© ëª¨ë¸
  * [S-BERT (Sentence BERT)](https://github.com/WannaBeSuperteur/AI-study/blob/main/Natural%20Language%20Processing/Basics_BERT%2C%20SBERT%20%EB%AA%A8%EB%8D%B8.md)
* ì…ë ¥ ë°ì´í„°
  * í˜„ì¬ ì§ˆë¬¸ ```current_question``` & ì‚¬ìš©ì ë‹µë³€ ```user_input``` & ë‚¨ì€ ë‹µë³€ ```current_remaining_user_answer```
  * ê°ê°ì˜ 'ë‹¤ìŒ ì§ˆë¬¸ (ì£¼ì œ)' (```next_question```) í›„ë³´
* ì¶œë ¥ ê°’
  * Cosine Similarity (ìœ ì‚¬ë„)

| í•™ìŠµ ë°ì´í„°                                                                           | í…ŒìŠ¤íŠ¸ ë°ì´í„°                                                                                    | ```next_question``` candidates                                                                                                                                     |
|----------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [dataset_df_next_question_train.csv](dataset/dataset_df_next_question_train.csv) | [dataset_df_next_question_valid_test.csv](dataset/dataset_df_next_question_valid_test.csv) | - í›„ë³´ ëª©ë¡: [candidates_next_question.txt](dataset/candidates_next_question.txt)<br>- ë²¡í„° ì„ë² ë”© í¬í•¨: [embeddings_next_question.csv](dataset/embeddings_next_question.csv) |

### 1-3. LLMì— ì˜í•œ ë‹¤ìŒ ì§ˆë¬¸ ìƒì„±

![image](../../images/250702_15.PNG)

* ì‚¬ìš© ëª¨ë¸
  * Causal LLM
  * Kanana-1.5 2.1B instruct (by Kakao) [(HuggingFace)](https://huggingface.co/kakaocorp/kanana-1.5-2.1b-instruct-2505)
* ì…ë ¥ ë°ì´í„°
  * í˜„ì¬ ì§ˆë¬¸ ```current_question``` & ì‚¬ìš©ì ë‹µë³€ ```user_input```
  * ì‚¬ìš©ìê°€ ì„±ê³µí•œ ë‹µë³€ ```output_answered```
  * ë‹¤ìŒ ì§ˆë¬¸ ì£¼ì œ ```output_next_question```
* ì¶œë ¥ ê°’
  * LLMì— ì˜í•´ ìƒì„±ëœ ë‹¤ìŒ ì§ˆë¬¸ 

| í•™ìŠµ ë° valid/test ë°ì´í„°                                                                                                                          |
|----------------------------------------------------------------------------------------------------------------------------------------------|
| [all_train_and_test_data.csv](../ai_interview/dataset/all_train_and_test_data.csv), with **483** train rows, **81** valid rows (= questions) |

## 2. ì‹¤í—˜ ê²°ê³¼

* **[1] ê²°ë¡  ìš”ì•½**

| í•­ëª©                     | ```output_answered```<br>(ì‚¬ìš©ì ë‹µë³€ ì„±ê³µ ì—¬ë¶€ í‰ê°€)                | ```next_question```<br>(ë‹¤ìŒ ì§ˆë¬¸ ì„ íƒ)                                  | LLM<br>(ë‹¤ìŒ ì§ˆë¬¸ ìƒì„±)                                                                                                        |
|------------------------|-----------------------------------------------------------|--------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| ì‚¬ìš© ëª¨ë¸                  | **S-BERT**<br>(roberta-base, 40 epochs)                   | **S-BERT**<br>(roberta-base, 40 epochs)                            | **Causal LLM**<br>([Kanana-1.5 2.1B instruct](https://huggingface.co/kakaocorp/kanana-1.5-2.1b-instruct-2505), 5 epochs) |
| í‰ê°€                     | **ì‹¤ì œ ì œí’ˆ ì ìš© ê°€ëŠ¥ ìˆ˜ì¤€**<br>(ì •í™•ë„ ì¶©ë¶„íˆ ë†’ìŒ)                        | **ì •í™•ë„ ë§¤ìš° ìš°ìˆ˜**                                                      | **ì‹¤ì œ ì œí’ˆ ì ìš© ê°€ëŠ¥ ìˆ˜ì¤€**<br>(ì •í™•ë„ ì¶©ë¶„íˆ ë†’ìŒ)                                                                                       |
| ìµœì¢… ì •í™•ë„ (Accuracy)      | **96.3 % (77 / 80)**<br>(```Mean_Diff``` : 0.9201)        | **100.0 % (80 / 80)**<br>(```Mean_Diff``` : 0.9938)                | **97.8 % (317 / 324)**                                                                                                   |
| ìµœì¢… MSE, MAE, Corr-coef | - MSE : 0.0026<br> - MAE : 0.0054<br>- Corr-coef : 0.9631 | - MSE : 0.00004 (= 4e-5)<br>- MAE : 0.0034<br>- Corr-coef : 0.9996 | -                                                                                                                        |

* **[2] S-BERT ëª¨ë¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼**
  * ```Accuracy```
    * S-BERT ëª¨ë¸ì´ **ê° í›„ë³´ ë‹µë³€ê³¼ì˜ ìœ ì‚¬ë„ ë¹„êµ** ë¥¼ í†µí•´ ê²°ì •í•œ **ì½”ì‚¬ì¸ ìœ ì‚¬ë„ê°€ ê°€ì¥ ë†’ì€ ë‹µë³€** ì´, ì‹¤ì œ ground truth ì¸ ë¹„ìœ¨ 
  * ```Mean_Diff```
    * ê° ì§ˆë¬¸ì— ëŒ€í•´,
      * (ì½”ì‚¬ì¸ ìœ ì‚¬ë„ê°€ ê°€ì¥ ë†’ì€ í›„ë³´ ë‹µë³€) ê³¼ (ground truth) ê°€ **ì¼ì¹˜í•˜ëŠ”** ê²½ìš°
        * **(+1.0)** * {1ìœ„ í›„ë³´ (= ground truth) ì— ëŒ€í•œ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ì™€, 2ìœ„ í›„ë³´ì— ëŒ€í•œ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ì˜ ì°¨ì´}
      * (ì½”ì‚¬ì¸ ìœ ì‚¬ë„ê°€ ê°€ì¥ ë†’ì€ í›„ë³´ ë‹µë³€) ê³¼ (ground truth) ê°€ **ì„œë¡œ ë‹¤ë¥¸** ê²½ìš°
        * **(-1.0)** * {ì‹¤ì œ ground truth ë‹µë³€ì— ëŒ€í•œ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ì™€, 1ìœ„ í›„ë³´ (= ì˜¤ë‹µ) ì— ëŒ€í•œ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ì˜ ì°¨ì´}
  * **roberta-base, 40 epochs** ê¸°ì¤€
  * ë°ì´í„°ì…‹ì—ì„œ **ì •ë‹µ** ë§¤ì¹­, **ì˜¤ë‹µ** ë§¤ì¹­ ê°ê° ground-truth cos-sim ì„ **+1.0, 0.0** ìœ¼ë¡œ ì§€ì •

| í•­ëª©              | ```output_answered```<br>(ì‚¬ìš©ì ë‹µë³€ ì„±ê³µ ì—¬ë¶€ í‰ê°€) | ```next_question```<br>(ë‹¤ìŒ ì§ˆë¬¸ ì„ íƒ) |
|-----------------|--------------------------------------------|-----------------------------------|
| ```Accuracy```  | 95.0 % (76 / 80)                           | 100.0 % (80 / 80)                 |
| ```Mean_Diff``` | 0.9056                                     | 0.9897                            |

* **[3] LLM í…ŒìŠ¤íŠ¸ ê²°ê³¼**
  * í‰ê°€ ê¸°ì¤€
    * LLM ë‹µë³€ í˜•ì‹ ì í•©ì„± (ë‹µë³€ì´ ë²ˆí˜¸ë‚˜ ë‚ ì§œë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš° ë¶€ì í•© íŒë‹¨) 
    * ê° ì§ˆë¬¸ ë‹¹ **ì´ 4íšŒ ìƒì„±** 
  * í‰ê°€ ê²°ê³¼
    * ```Accuracy``` : 97.8 % (317 / 324)
    * ì‚¬ìš© ëª¨ë¸ ë° ì„¤ì •
      * ëª¨ë¸ : ```Kanana-1.5 2.1B instruct``` [(HuggingFace)](https://huggingface.co/kakaocorp/kanana-1.5-2.1b-instruct-2505) 
      * **5 epochs** ë™ì•ˆ Fine-Tuning í•™ìŠµ
      * inference ì‹œì˜ [temperature](https://github.com/WannaBeSuperteur/AI-study/blob/main/AI%20Basics/LLM%20Basics/LLM_%EA%B8%B0%EC%B4%88_Decoding_Strategies.md#2-5-temperature-%EC%A1%B0%EC%A0%95) : **0.6**

* **[4] ì°¸ê³  ì‚¬í•­**
  * S-BERT í‰ê°€ ê²°ê³¼ì˜ MSE, MAE, Corr-coef ëŠ” **ì½”ì‚¬ì¸ ìœ ì‚¬ë„ì˜ ì˜ˆì¸¡ê°’ vs. ì‹¤ì œ ê°’** ë¹„êµ ê¸°ì¤€ 

### 2-1. S-BERT ëª¨ë¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼ (5, 10, 20, 40 epochs)

* ê²°ë¡  ìš”ì•½
  * í•™ìŠµ epoch íšŸìˆ˜ê°€ í´ìˆ˜ë¡ ëŒ€ì²´ë¡œ ì„±ëŠ¥ì´ í–¥ìƒë¨

* ìƒì„¸ ë¶„ì„
  * 1ì°¨ ë°ì´í„°ì…‹ â†’ 2ì°¨ ë°ì´í„°ì…‹
    * **ë¬´ì—‡ì¸ê°€ (ì˜ˆ: ì†ì‹¤ í•¨ìˆ˜) ì˜ ì •ì˜ë¥¼ ë¬»ëŠ” ì§ˆë¬¸** ì— ëŒ€í•œ í•™ìŠµ ë°ì´í„°ì…‹ ì¦ëŸ‰
  * 2ì°¨ ë°ì´í„°ì…‹ â†’ ìµœì¢… ë°ì´í„°ì…‹
    * ```output_answered``` S-BERT ëª¨ë¸ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´, **ì†ì‹¤ í•¨ìˆ˜ ê´€ë ¨ ê²½í—˜** ì§ˆë¬¸ì— ëŒ€í•œ ì‚¬ìš©ì ì…ë ¥ (ì‚¬ìš©ì ë‹µë³€) ë¶€ë¶„ì— **ê¸°ë³¸ ê²½í—˜ & ìƒì„¸ ê²½í—˜** ì„ êµ¬ë¶„

| í•­ëª©                                       | ```output_answered```<br>(ì‚¬ìš©ì ë‹µë³€ ì„±ê³µ ì—¬ë¶€ í‰ê°€) | ```next_question```<br>(ë‹¤ìŒ ì§ˆë¬¸ ì„ íƒ)    |
|------------------------------------------|--------------------------------------------|--------------------------------------|
| ```Accuracy```<br>(**1ì°¨, 2ì°¨, ìµœì¢…** ë°ì´í„°ì…‹)  | ![image](../../images/250702_18.PNG)       | ![image](../../images/250702_17.PNG) |
| ```Mean_Diff```<br>(**1ì°¨, 2ì°¨, ìµœì¢…** ë°ì´í„°ì…‹) | ![image](../../images/250702_20.PNG)       | ![image](../../images/250702_19.PNG) |
| MSE, MAE, Corr-coef (ìƒê´€ê³„ìˆ˜)               | ![image](../../images/250702_22.PNG)       | ![image](../../images/250702_21.PNG) |

### 2-2. S-BERT ìµœì¢… ëª¨ë¸ ì˜¤ë‹µ ë¶„ì„ (output_answered)

* ê²°ë¡ 
  * **Loss Functionì˜ ì •ì˜** ìª½ì—ì„œ ```ë‹µë³€ ì‹¤íŒ¨``` í•œ ê²½ìš°ë¥¼ ```Loss Function ì •ì˜``` ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë‹µí•œ ê²ƒìœ¼ë¡œ íŒë‹¨í•œ ì˜¤ë‹µì´ ë§ì´ ë‚˜ì˜´

* ìƒì„¸ ì˜¤ë‹µ
  * ì‚¬ëŒì— ë”°ë¼ ```ë‹µë³€ ì„±ê³µ``` ìœ¼ë¡œë„, ```ë‹µë³€ ì‹¤íŒ¨``` ë¡œë„ ë³¼ ìˆ˜ ìˆëŠ” ì¼€ì´ìŠ¤ì—ì„œ ì˜¤ë‹µì´ ë°œìƒí•˜ëŠ” ê²½ìš°ê°€ ìˆìŒ. ì´ì™€ ê°™ì€ ì¼€ì´ìŠ¤ëŠ” **ì‹¬ê°ì„±ì´ ë‚®ì€ ì˜¤ë‹µ** ì„.

| í˜„ì¬ ì§ˆë¬¸                                          | ì‚¬ìš©ì ë‹µë³€ (= ì‚¬ìš©ì ì…ë ¥)                          | S-BERT ì˜ˆì¸¡<br>(ì½”ì‚¬ì¸ ìœ ì‚¬ë„)                    | ì‹¤ì œ<br>(ì½”ì‚¬ì¸ ìœ ì‚¬ë„)                        |
|------------------------------------------------|--------------------------------------------|-------------------------------------------|----------------------------------------|
| ```Loss Function ì •ì˜```                         | ```Loss Function ì€ ë”¥ëŸ¬ë‹ ëª¨ë¸ì˜ ì†í•´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í•¨ìˆ˜ì•¼``` | ```Loss Function ì •ì˜``` ë‹µë³€ ì„±ê³µ<br>(+0.9595) | ```ë‹µë³€ ì‹¤íŒ¨```<br>(+0.1589)               |
| ```Multi-Class, Multi-Label ì¤‘ BCE ê°€ ì¢‹ì€ task``` | ```Multi-Label ì´ë¼ê³  ë“£ê¸´ í–ˆëŠ”ë° ê·¸ ì´ìœ ëŠ” ì˜ ëª¨ë¥´ê² ì–´```  | ```ë‹µë³€ ì‹¤íŒ¨```<br>(+0.9994)                  | ```BCE ê°€ ì¢‹ì€ task``` ë‹µë³€ ì„±ê³µ<br>(-0.0014) |
| ```Loss Function ì •ì˜```                         | ```ì†ì‹¤ í•¨ìˆ˜ëŠ” ë”¥ëŸ¬ë‹ ëª¨ë¸ì´ ì–¼ë§ˆë‚˜ ëˆì„ ìƒì—ˆëŠ”ì§€ ë‚˜íƒ€ë‚´ëŠ” ê±°ì•¼```   | ```Loss Function ì •ì˜``` ë‹µë³€ ì„±ê³µ<br>(+0.9967) | ```ë‹µë³€ ì‹¤íŒ¨```<br>(+0.0001)               |

* ì‹¤ì œ ì œí’ˆ ë°˜ì˜ ì‚¬í•­
  * ì‚¬ìš©ìê°€ ì§ˆë¬¸ì— ëŒ€í•´ **ëª¨ë¥´ë©´ ëª¨ë¥´ê² ë‹¤ê³  ì†”ì§íˆ ë‹µí•˜ë„ë¡** ìœ ë„ (ì‹¤ì œ ë©´ì ‘ì—ì„œë„ ì¤‘ìš”í•¨)
  * ì‚¬ìš©ìê°€ ë‹µë³€ì„ í•  ë•Œ ```~ì¸ë° ì˜ ëª¨ë¥´ê² ì–´``` ì™€ ê°™ì´ **í™•ì‹ ì´ ì—†ëŠ” í‘œí˜„ì„ ìì œ** í•˜ë„ë¡ ìœ ë„ (ì‹¤ì œ ë©´ì ‘ì—ì„œë„ ìœ íš¨)

### 2-3. LLM í…ŒìŠ¤íŠ¸ ê²°ê³¼

* ê²°ë¡ 
  * **Kanana-1.5-2.1B instruct** ëª¨ë¸ë¡œ **5 epochs** ë™ì•ˆ í•™ìŠµ ì‹œ, ì •í™•ë„ **97.8 %** ë¡œ ê°€ì¥ ì¢‹ì€ ì„±ëŠ¥ ê¸°ë¡
  * ì‹¤ì œ Oh-LoRA ë©´ì ‘ê´€ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ìˆ˜ì¤€

* LLM Fine-Tuning ì •í™•ë„ ìš”ì•½
  * ë‹¤ìŒ ì¡°ê±´ í•˜ì—ì„œ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ìŒ 
    * **Kanana-1.5-2.1B instruct** ëª¨ë¸ë¡œ í•™ìŠµ
    * **5 epochs** ë™ì•ˆ í•™ìŠµ 
  * **í˜•ì‹ ì í•© ë¹„ìœ¨** : ìˆ«ìë¡œ ì‹œì‘í•˜ëŠ” ë“± **í˜•ì‹ì´ ë§ì§€ ì•ŠëŠ”** ë‹µë³€ì´ ì•„ë‹Œ ë¹„ìœ¨ (ì˜ˆ: ```3. ì•„! ê·¸ê±° ì—„ì²­ ëŒ€ë‹¨í•œ ê±°ì˜€ì–ì•„! ê·¸ë˜ì„œ ë‚´ê°€ ìˆ˜í•™ ê³µë¶€í•˜ëŠë¼ê³  í˜ë“¤ì–´í–ˆêµ¬ë‚˜!```)
    * [Kanana-1.5 2.1B Fine-Tuning ì¤‘ ìˆ«ìë¡œ ì‹œì‘í•˜ëŠ” ë‹µë³€ ë°œìƒ ì´ìŠˆ (Oh-LoRA v3, 2025.06.01)](https://github.com/WannaBeSuperteur/AI_Projects/issues/21#issuecomment-2926279503)
    * í˜•ì‹ ì í•© ë¹„ìœ¨ 97.5 % (316 / 324) ë¯¸ë§Œì€ **í˜•ì‹ ë¶€ì ê²©** ìœ¼ë¡œ ê°„ì£¼í•˜ì—¬ íƒˆë½ (ì •í™•ë„ ë¯¸ ì¸¡ì •)

* ìƒì„¸ ì •í™•ë„ ê¸°ë¡

**[ dataset ver 2 ]**

* í•™ìŠµ ë°ì´í„° ê°œìˆ˜ ì¦ëŸ‰ (248 rows â†’ 483 rows, ì•½ 2ë°°)

| epochs | Kanana-1.5-2.1B instruct ëª¨ë¸ | Mi:dm 2.0 ëª¨ë¸             |
|--------|-----------------------------|--------------------------|
| 3      | **95.4 %** (309 / 324)      | **96.9 %** (314 / 324)   |
| 5      | **97.8 %** (317 / 324) ğŸ‘   | **94.8 %** (307 / 324)   |
| 10     | **87.7 %** (284 / 324)      | **(í˜•ì‹ ì í•© ë¹„ìœ¨ 97.5 % ë¯¸ë§Œ)** |
| 20     | **95.7 %** (310 / 324)      | **(í˜•ì‹ ì í•© ë¹„ìœ¨ 97.5 % ë¯¸ë§Œ)** |
| 30     | **(í˜•ì‹ ì í•© ë¹„ìœ¨ 97.5 % ë¯¸ë§Œ)**    |                          |
| 40     | **(í˜•ì‹ ì í•© ë¹„ìœ¨ 97.5 % ë¯¸ë§Œ)**    |                          |

**[ dataset ver 1 ]**

| epochs | Kanana-1.5-2.1B instruct ëª¨ë¸ | Mi:dm 2.0 ëª¨ë¸                    |
|--------|-----------------------------|---------------------------------|
| 3      | **92.9 %** (301 / 324)      | **92.6 %** (300 / 324)          |
| 5      | **93.2 %** (302 / 324) ğŸ‘   | **90.7 %** (294 / 324)          |
| 10     | **89.5 %** (290 / 324)      | **í˜•ì‹ ì í•© ë¹„ìœ¨** 91.4 % (296 / 324) |
| 20     | **92.0 %** (298 / 324)      | **í˜•ì‹ ì í•© ë¹„ìœ¨** 92.0 % (298 / 324) |

**[ ì°¸ê³ : í˜•ì‹ ë¶€ì í•© ë‹µë³€ ì¼€ì´ìŠ¤ ]**

* ìˆ«ì/ë²ˆí˜¸ë¡œ ì‹œì‘
  * ```â‘  ë¶„ë¥˜ ë¬¸ì œì—ì„œ MSEë¥¼ ì˜ ì•ˆ ì“°ëŠ” ì´ìœ ëŠ”? ğŸ¤·â€â™€``` 
  * ```1. ì •ë‹µ! ğŸ™†â€â™€ï¸ ê·¸ëŸ¼ BCE Loss ê³µì‹ í•œë²ˆ ë§í•´ë´!```
* ë‚ ì§œë¡œ ì‹œì‘
  * ```2023ë…„ 4ì›” 28ì¼ ì˜¤í›„ 2ì‹œ 29ë¶„! ì´ê²Œ ì•„ì£¼ ì¤‘ìš”í•œ ì‚¬ì‹¤ì´ì§€? âœ¨```
  * ```2024-06-01 11:13:00 ë‚˜ê°™ì´ LLM Fine-Tuning ì¤‘ PEFT ê°€ ë­˜ê¹Œ? ğŸ˜Š```
* ê¸°íƒ€
  * ```1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20``` (í›„ëµ) 

## 3. ì½”ë“œ ì‹¤í–‰ ë°©ë²•

ëª¨ë“  ì½”ë“œëŠ” **ë¨¼ì € LLM ëª¨ë¸ ì •ë³´ ë° ë‹¤ìš´ë¡œë“œ ê²½ë¡œ ì•ˆë‚´ (TBU) ë° í•´ë‹¹ ê° HuggingFace ë§í¬ì— ìˆëŠ” Model Card ì— ë‚˜íƒ€ë‚œ ì €ì¥ ê²½ë¡œ (Save Path) ì •ë³´ë¥¼ ì°¸ê³ í•˜ì—¬ ëª¨ë¸ ë‹¤ìš´ë¡œë“œ í›„,** ```2025_07_02_OhLoRA_ML_Tutor``` (í”„ë¡œì íŠ¸ ë©”ì¸ ë””ë ‰í† ë¦¬) ì—ì„œ ì‹¤í–‰

### 3-1. S-BERT Training (ì‚¬ìš©ìê°€ ì„±ê³µì ìœ¼ë¡œ í•œ ë‹µë³€, ë‹¤ìŒ ì§ˆë¬¸ ì˜ˆì¸¡ ê°ê°)

* ì§€ì •ëœ ê²½ë¡œì— í•´ë‹¹ S-BERT ëª¨ë¸ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°, Fine-Tuning ëŒ€ì‹  **inference test ì‹¤í–‰ë¨**

```python ai_interview/run_sbert.py```

### 3-2. S-BERT ëª¨ë¸ì˜ ì •í™•ë„ ì¸¡ì •

* ì…ë ¥
  * ```next_question``` S-BERT ëª¨ë¸ ìƒì„¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼ (```next_question_sbert/result/test_result_..._epoch_{epochs}.csv```)
  * ```output_answer``` S-BERT ëª¨ë¸ ìƒì„¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼ (```output_answer/result/test_result_..._epoch_{epochs}.csv```)
* ì¶œë ¥
  * ```next_question``` S-BERT ëª¨ë¸ ì •í™•ë„ ì¸¡ì • ê²°ê³¼ (```next_question_sbert/result/test_accuracy.csv```)
  * ```output_answer``` S-BERT ëª¨ë¸ ì •í™•ë„ ì¸¡ì • ê²°ê³¼ (```output_answer_sbert/result/test_accuracy.csv```)

```python ai_interview/run_compute_sbert_accuracy.py```

### 3-3. LLM Inference ë˜ëŠ” Fine-Tuning

* ê¸°ë³¸í˜•
  * ```python ai_interview/run_llm_fine_tuning```
* **ë¯¿:ìŒ 2.0** LLM ì‹¤í–‰
  * ```python ai_interview/run_llm_fine_tuning -llm_names midm```
* **5íšŒ (ê¸°ë³¸ê°’)** ê°€ ì•„ë‹Œ ë‹¤ë¥¸ epoch ë¡œ Fine-Tuning
  * ì˜ˆ: 20 epochs ë™ì•ˆ Fine-Tuning 
  * ```python ai_interview/run_llm_fine_tuning -epochs 20```
